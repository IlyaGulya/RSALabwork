
<!DOCTYPE html>
<html lang="en">
    <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="SibSUTIS 2016 RSA Lab">
    <meta name="author" content="Ilya Gulya - ilyagulya@gmail.com">
    <link rel="shortcut icon" href="assets/ico/favicon.png">

    <title>RSA</title>

    <!-- Bootstrap core CSS -->
    <link href="assets/css/bootstrap.css" rel="stylesheet">

    <!-- Custom styles for this template -->
    <link href="assets/css/main.css" rel="stylesheet">

    <link href="assets/fonts/lato.css" rel="stylesheet" type="text/css">
    <link href="assets/fonts/raleway.css" rel="stylesheet" type="text/css">
  </head>
  <body data-spy="scroll" data-offset="0" data-target="#navigation">
      <div id="navigation" class="navbar navbar-default navbar-fixed-top">
          <div class="container">
              <div class="navbar-header">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                  <span class="icon-bar"></span>
                  <span class="icon-bar"></span>
                  <span class="icon-bar"></span>
                </button>
                <a class="navbar-brand" href="#azaz" id="azaz">
                  <b>RSA</b><br>
                </a>
              </div>
              <div class="navbar-collapse collapse">
                  <ul class="nav navbar-nav">
                    <li id="hello">
                      <a href="#hello" class="smothscroll">Приветствие</a>
                    </li>
                    <li id="theory">
                      <a href="#theory" class="smothscroll">Теория</a>
                    </li>
                    <li id="lab">
                      <a href="#lab" class="smothscroll">Лабораторная</a>
                    </li>
                    <li id="test">
                      <a href="#test" class="smothScroll">Тест</a>
                    </li>
                    <li id="result">
                      <a href="#result" class="smothScroll">Результаты</a>
                    </li>
                  </ul>
              </div>
          </div>
      </div>
      <div class="container" id="content">
        <div class="jumbotron" data-id="hello">
          <h1>Привет</h1>
          <p>Приветствую тебя в этой лабораторной работе, студент. Надеюсь, выполнение её доставит тебе удовольствие, да не разочарован будешь ты результатами работы сей.</p>
          <p>
            <a class="btn btn-primary btn-lg" role="button" href="#theory">Перейти к теории</a>
          </p>
        </div>
        <div class="container" data-id="theory">
          <div class="row">
            <h1>Введение</h1>
            <p>Алгоритм RSA стоит у истоков асимметричной криптографии. Он был предложен тремя исследователями-математиками: Рональдом Ривестом (R.Rivest), Ади Шамиром (A.Shamir) и Леонардом Адльманом (L.Adleman) в 1977-78 годах.</p>
            <p>
                RSA -- криптографический алгоритм с открытым ключом. RSA стал первым алгоритмом такого типа, пригодным и для шифрования и для цифровой подписи.<br>
            </p>
            <p>
                Безопасность алгоритма RSA основана на трудности задачи разложения на множители. Алгоритм использует два ключа -- открытый и секретный, вместе открытый и соответствующий ему секретный ключи образуют пару ключей (keypair). Открытый ключ не требуется сохранять в тайне, он используется для шифрования данных. Если сообщение было зашифровано открытым ключом, то расшифровать его можно только соответствующим секретным ключом.<br>
            </p>
            <p>
                Первым этапом любого асимметричного алгоритма является создание пары ключей - открытого и закрытого - и распространение открытого ключа "по всему миру". Для алгоритма RSA этап создания ключей состоит из следующих операций:<br>
            </p>
            <ul>
                <li>
                    выбираются два простых числа <i><b>p</b></i> и <i><b>q</b></i><br>
                </li>
                <li>вычисляется их произведение <i><b>n=p*q</b></i></li>
                <li>
                    вычисляется функция Эйлера <i><b>с=(p -1)(q-1)</b></i><br>
                </li>
                <li>
                    выбирается произвольное число <i><b>d (d&lt;n)</b></i>, такое, что <i><b>НОД(d, c)=1</b></i>, то есть должно быть взаимно простым с числом <i><b>c</b></i><br>
                </li>
                <li>
                    затем вычисляется число e таким образом, что <i><b>(e*d)</b></i> делится на <i><b>c</b></i> с остатком, равным <i><b>1</b></i><br>
                </li>
                <li>
                    два числа <i><b>(e, n)</b></i> - публикуются как открытый ключ<br>
                </li>
            </ul>
            <p>Число <i><b>d</b></i> хранится в строжайшем секрете. Пара чисел <i><b>(d, n)</b></i> - это и есть закрытый ключ, который позволит читать все послания, зашифрованные с помощью пары чисел <i><b>(e,n)</b></i>.</p>
            <p>
                Число <i><b>n</b></i> называется модулем, а числа <i><b>e</b></i> и <i><b>d</b></i> - открытой и секретной экспонентами. Числа <i><b>p</b></i> и <i><b>q</b></i> после генерации пары ключей могут быть уничтожены, но ни в коем случае не должны быть раскрыты.<br>
            </p>
            <h1>
                Шифрование<br>
            </h1>
            <p>
                Отправитель разбивает свое сообщение на блоки, каждый из которых может быть представлен в виде числа M(<i><b>i</b></i>)=0,1,2,…<i><b>n</b></i>-1. Далее текст шифруется как последовательность чисел M(<i><b>i</b></i>) по формуле:<br>
            </p>
            <p>
                S(<i><b>i</b></i>)= (M(<i><b>i</b></i>)^<i><b>e</b></i>) mod <i><b>n</b></i>.<br>
            </p>
            <p>
                Операция <i><b>a</b></i> mod <i><b>b</b></i> означает взятие остатка от деления <i><b>a</b></i> на <i><b>b</b></i>.<br>
            </p>
            <h1>Дешифрация</h1>
            <p>
                Чтобы расшифровать эти данные, используя секретный ключ <i><b>(d,n)</b></i>, необходимо выполнить следующие вычисления:<br>
            </p>
            <p>
                M(<i><b>i</b></i>)= (S(<i><b>i</b></i>)^<i><b>d</b></i>) mod <i><b>n</b></i>.<br>
            </p>
            <p>
                Зависимость между <i><b>e</b></i> и <i><b>d</b></i> гарантирует, что сообщение будет расшифровано верно.<br>
            </p>
            <h1>Дополнение сообщений</h1>
            <p>
                При практическом использовании необходимо некоторым образом дополнять сообщения. Отсутствие дополнений может привести к некоторым проблемам:<br>
            </p>
            <ul>
                <li>
                    значения <i><b>m</b></i>=0 и <i><b>m</b></i>=1 дадут при зашифровании шифротексты 0 и 1 при любых значениях <i><b>e</b></i> и <i><b>n</b></i>.<br>
                </li>
                <li>
                    при малом значении открытого показателя (<i><b>e</b></i>=3, например) возможна ситуация, когда окажется, что (M(<i><b>i</b></i>)^<i><b>e</b></i>) &lt; <i><b>n</b></i>. Тогда S(i)=(M(i)^e) mod n = (M(<i><b>i</b></i>)^<i><b>b</b></i>), и нарушитель легко сможет восстановить исходное сообщение, вычислив корень степени <i><b>e</b></i> из <i><b>c</b></i>.<br>
                </li>
                <li>
                    поскольку RSA является детерминированным алгоритмом, т.е. не использует случайных значений в процессе работы, то нарушитель может использовать атаку с выбранным открытым текстом.<br>
                </li>
            </ul>
            <p>
                Для решения перечисленных проблем сообщения дополняются перед каждым зашифрованием некоторым случайным значением -- солью. Дополнение выполняется таким образом, чтобы гарантировать, что <i><b>m</b></i> ≠ 0 и <i><b>m</b></i> ≠ 1, и (M(<i><b>i</b></i>)^<i><b>e</b></i>) &lt; <i><b>n</b></i>. Кроме того, поскольку сообщение дополняется случайными данными, то, зашифровывая один и тот же открытый текст, мы каждый раз будем получать другое значение шифртекста, что делает атаку с выбранным открытым текстом невозможной.<br>
            </p>
            <p>
                Число <i><b>n</b></i> должно иметь размер не меньше 512 бит. В настоящий момент (2006 год) система шифрования на основе RSA считается надёжной, начиная с размера <i><b>n</b></i> в 1024 бита.<br>
            </p>
            <p>
                Так как шифруются блоки текста, а в общем случае они не совпадают с буквами, то метод RSA устойчив ко взлому методом анализа статистики повторяемости букв.<br>
            </p>
            <h1>Применение RSA</h1>
            <p>
                Система RSA используется для защиты программного обеспечения и в схемах цифровой подписи. Также она используется в открытой системе шифрования PGP.<br>
            </p>
            <p>Криптосистема RSA используется в самых различных продуктах, на различных платформах и во многих отраслях. В настоящее время криптосистема RSA встраивается во многие коммерческие продукты, число которых постоянно увеличивается. Также, ее используют операционные системы Microsoft, Apple, Sun и Novell. В аппаратном исполнении RSA алгоритм применяется в защищенных телефонах, на сетевых платах Ethernet, на смарт-картах, широко используется в криптографическом оборудовании THALES (Racal). Кроме того, алгоритм входит в состав всех основных протоколов для защищенных коммуникаций Internet, в том числе S/MIME, SSL и S/WAN, а также используется во многих учреждениях, например, в правительственных службах, в большинстве корпораций, в государственных лабораториях и университетах. На осень 2000 года технологии с применением алгоритма RSA были лицензированы более чем 700 компаниями.</p>
            <p>
              <a class="btn btn-primary btn-lg" role="button" href="#lab">Перейти к лабораторной работе</a>
            </p>
          </div>
        </div>
        <div class="container" data-id="lab">
          <div class="row" data-step="inputPQ">
            <div class="col-md-12">
              <div class="col-md-5 margin-vertical">Введите два различных простых числа P и Q.</div>
            </div>
          </div>
          <div class="row" data-step="inputPQ">
            <div class="col-md-12">
              <div class="col-md-6 input-group">
                <input type="text" class="form-control text-center" placeholder="Число P" id="numberP"/>
                <span class="input-group-addon" style="border-left: 0; border-right: 0;">и</span>
                <input type="text" class="form-control text-center" placeholder="Число Q" id="numberQ"/>
                <div class="input-group-btn">
                  <button type="button" class="btn btn-default ready" data-step="inputPQ">Готово</button>
                </div>
              </div>
            </div>
          </div>
          <div class="row">
            <div class="col-md-12">
              <div class="col-md-3" data-step="inputN">
                <div class="margin-vertical">
                  Введите число N
                </div>
                <div class="input-group">
                  <input type="text" class="form-control text-center" placeholder="Число N" id="numberN"/>
                  <div class="input-group-btn">
                    <button type="button" class="btn btn-default ready" data-step="inputN">Готово</button>
                  </div>
                </div>
              </div>
              <div class="col-md-3" data-step="inputC">
                <div class="margin-vertical">
                  Введите число C
                </div>
                <div class="input-group">
                  <input type="text" class="form-control text-center" placeholder="Число C" id="numberC"/>
                  <div class="input-group-btn">
                    <button type="button" class="btn btn-default ready" data-step="inputC">Готово</button>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div class="row" data-step="inputD">
            <div class="col-md-12">
              <div class="col-md-4 margin-vertical">Наименьшее, взаимно простое с C число D</div>
            </div>
          </div>
          <div class="row" data-step="inputD">
            <div class="col-md-12">
              <div class="col-md-3 input-group">
                <input type="text" class="form-control text-center" placeholder="Число D" id="numberD"/>
                <div class="input-group-btn">
                  <button type="button" class="btn btn-default ready" data-step="inputD">Готово</button>
                </div>
              </div>
            </div>
          </div>
          <div class="row" data-step="inputE">
            <div class="col-md-12">
              <div class="col-md-4 margin-vertical">Введите число E</div>
            </div>
          </div>
          <div class="row" data-step="inputE">
            <div class="col-md-12">
              <div class="col-md-3 input-group">
                <input type="text" class="form-control text-center" placeholder="Число E" id="numberE"/>
                <div class="input-group-btn">
                  <button type="button" class="btn btn-default ready" data-step="inputE">Готово</button>
                </div>
              </div>
            </div>
          </div>
          <div class="row">
            <div class="col-md-12">
              <div class="col-md-4 margin-vertical" data-step="inputPublicKey">
                <div class="margin-vertical">
                  Введите пару чисел, составляющих <b>открытый</b> ключ
                </div>
                <div class="input-group">
                  <input type="text" class="form-control text-center" id="publickey-1" />
                  <span class="input-group-addon" style="border-left: 0; border-right: 0;">и</span>
                  <input type="text" class="form-control text-center" id="publickey-2" />
                  <div class="input-group-btn">
                    <button type="button" class="btn btn-default ready" data-step="inputPublicKey">Готово</button>
                  </div>
                </div>
              </div>
              <div class="col-md-4 margin-vertical" data-step="inputPrivateKey">
                <div class="margin-vertical">
                  Введите пару чисел, составляющих <b>закрытый</b> ключ
                </div>
                <div class="input-group">
                  <input type="text" class="form-control text-center" id="privatekey-1" />
                  <span class="input-group-addon" style="border-left: 0; border-right: 0;">и</span>
                  <input type="text" class="form-control text-center" id="privatekey-2" />
                  <div class="input-group-btn">
                    <button type="button" class="btn btn-default ready" data-step="inputPrivateKey">Готово</button>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div class="row" data-step="inputMessage">
            <div class="col-md-12">
              <table class="table table-striped table-bordered table-condensed">
                <thead>
                  <tr>
                    <td>
                      <b>Числа и знаки пунктуации</b>
                    </td>
                  </tr>
                </thead>
                <tbody>
                  <tr id="numberSymbol">
                    <td>
                      Символ
                    </td>
                  </tr>
                  <tr id="numberCode">
                    <td>
                      Число
                    </td>
                  </tr>
                  <tr id="pointingSymbol">
                    <td>
                      Символ
                    </td>
                  </tr>
                  <tr id="pointingCode">
                    <td>
                      Число
                    </td>
                  </tr>
                </tbody>
              </table>
              <table class="table table-striped table-bordered table-condensed">
                <thead>
                  <tr>
                    <td>
                      <b>Русский алфавит</b>
                    </td>
                  </tr>
                </thead>
                <tbody>
                  <tr id="russianLower1Symbol">
                    <td>
                      Символ
                    </td>
                  </tr>
                  <tr id="russianLower1Code">
                    <td>
                      Число
                    </td>
                  </tr>
                  <tr id="russianLower2Symbol">
                    <td>
                      Символ
                    </td>
                  </tr>
                  <tr id="russianLower2Code">
                    <td>
                      Число
                    </td>
                  </tr>
                  <tr id="russianUpper1Symbol">
                    <td>
                      Символ
                    </td>
                  </tr>
                  <tr id="russianUpper1Code">
                    <td>
                      Число
                    </td>
                  </tr>
                  <tr id="russianUpper2Symbol">
                    <td>
                      Символ
                    </td>
                  </tr>
                  <tr id="russianUpper2Code">
                    <td>
                      Число
                    </td>
                  </tr>
                </tbody>
              </table>
              <table class="table table-striped table-bordered table-condensed">
                <thead>
                  <tr>
                    <td>
                      <b>Английский алфавит</b>
                    </td>
                  </tr>
                </thead>
                <tbody>
                  <tr id="englishLower1Symbol">
                    <td>
                      Символ
                    </td>
                  </tr>
                  <tr id="englishLower1Code">
                    <td>
                      Число
                    </td>
                  </tr>
                  <tr id="englishLower2Symbol">
                    <td>
                      Символ
                    </td>
                  </tr>
                  <tr id="englishLower2Code">
                    <td>
                      Число
                    </td>
                  </tr>
                  <tr id="englishUpper1Symbol">
                    <td>
                      Символ
                    </td>
                  </tr>
                  <tr id="englishUpper1Code">
                    <td>
                      Число
                    </td>
                  </tr>
                  <tr id="englishUpper2Symbol">
                    <td>
                      Символ
                    </td>
                  </tr>
                  <tr id="englishUpper2Code">
                    <td>
                      Число
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
          <div class="row" data-step="inputMessage">
            <div class="col-md-12">
              <div class="col-md-4 margin-vertical">Введите сообщение для кодирования</div>
            </div>
          </div>
          <div class="row" data-step="inputMessage">
            <div class="col-md-12">
              <div class="col-md-4 input-group">
                <input type="text" class="form-control text-center" placeholder="Сообщение" id="message-encode"/>
                <div class="input-group-btn">
                  <button type="button" class="btn btn-default ready" data-step="inputMessage">Готово</button>
                </div>
              </div>
            </div>
          </div>
          <div class="row" data-step="inputMessageSequence">
            <div class="col-md-12">
              <div class="col-md-8 margin-vertical">
                Представьте ваше сообщение как последовательность цифр, соответствующих порядковому номеру символа в вышеуказанном алфавите (например, Б - 51, или F - 114). Цифры разделяйте запятыми.
              </div>
            </div>
          </div>
          <div class="row" data-step="inputMessageSequence">
            <div class="col-md-12">
              <div class="col-md-8 input-group">
                <input type="text" class="form-control text-center" placeholder="Последовательность" id="message-sequence"/>
                <div class="input-group-btn">
                  <button type="button" class="btn btn-default ready" data-step="inputMessageSequence">Готово</button>
                </div>
              </div>
            </div>
          </div>
          <div class="row" data-step="inputMessageSequenceEncoded">
            <div class="col-md-12">
              <div class="col-md-8 margin-vertical">
                Зашифруйте сообщение при помощи открытого ключа. Запишите последовательно через запятую зашифрованные значения
              </div>
            </div>
          </div>
          <div class="row" data-step="inputMessageSequenceEncoded">
            <div class="col-md-12">
              <div class="col-md-8 input-group">
                <input type="text" class="form-control text-center" placeholder="Последовательность" id="message-sequence-encoded"/>
                <div class="input-group-btn">
                  <button type="button" class="btn btn-default ready" data-step="inputMessageSequenceEncoded">Готово</button>
                </div>
              </div>
            </div>
          </div>
          <div class="row" data-step="inputWrongD">
            <div class="col-md-12">
              <div class="col-md-8 margin-vertical">
                Попробуем расшифровать сообщение другим закрытым ключом. Введите другое значение D.
              </div>
            </div>
          </div>
          <div class="row" data-step="inputWrongD">
            <div class="col-md-12">
              <div class="col-md-4 input-group">
                <input type="text" class="form-control text-center" placeholder="Значение D" id="numberWrongD"/>
                <div class="input-group-btn">
                  <button type="button" class="btn btn-default ready" data-step="inputWrongD">Готово</button>
                </div>
              </div>
            </div>
          </div>
          <div class="row" data-step="inputMessageSequenceDecodedWrong">
            <div class="col-md-12">
              <div class="col-md-8 margin-vertical">
                Введите получившееся расшифрованное сообщение в виде последовательности чисел, разделённых запятыми.
              </div>
            </div>
          </div>
          <div class="row" data-step="inputMessageSequenceDecodedWrong">
            <div class="col-md-12">
              <div class="col-md-8 input-group">
                <input type="text" class="form-control text-center" placeholder="Последовательность" id="message-sequence-decoded-wrong"/>
                <div class="input-group-btn">
                  <button type="button" class="btn btn-default ready" data-step="inputMessageSequenceDecodedWrong">Готово</button>
                </div>
              </div>
            </div>
          </div>
          <div class="row" data-step="inputMessageSequenceDecodedWrong">
            <div class="col-md-12">
              <div class="col-md-8 margin-vertical">
                Текстовое представление декодированного сообщения
              </div>
            </div>
          </div>
          <div class="row" data-step="inputMessageSequenceDecodedExample">
            <div class="col-md-12">
              <div class="col-md-8 input-group">
                <input type="text" class="form-control text-center" disabled id="message-decoded-wrong"/>
              </div>
            </div>
          </div>
          <div class="row" data-step="inputMessageSequenceDecodedExample">
            <div class="col-md-12">
              <div class="col-md-8 margin-vertical">
                Очевидно, что полученное сообщение не совпадает с исходным, ибо расшифровка другим закрытым ключом невозможна.
              </div>
            </div>
          </div>
          <div class="row" data-step="inputMessageSequenceDecodedExample">
            <div class="col-md-12">
              <div class="col-md-8 margin-vertical">
                Теперь попробуем расшифровать следующее сообщение, зашифрованное правильным открытым ключом:
              </div>
            </div>
          </div>
          <div class="row" data-step="inputMessageSequenceDecodedExample">
            <div class="col-md-12">
              <div class="col-md-8 input-group">
                <input type="text" class="form-control text-center" disabled id="message-sequence-encoded-example"/>
              </div>
            </div>
          </div>
          <div class="row" data-step="inputMessageSequenceDecodedExample">
            <div class="col-md-12">
              <div class="col-md-8 margin-vertical">
                Введите получившееся расшифрованное сообщение в виде последовательности чисел, разделённых запятыми.
              </div>
            </div>
          </div>
          <div class="row" data-step="inputMessageSequenceDecodedExample">
            <div class="col-md-12">
              <div class="col-md-8 input-group">
                <input type="text" class="form-control text-center" placeholder="Последовательность" id="message-sequence-decoded-example"/>
                <div class="input-group-btn">
                  <button type="button" class="btn btn-default ready" data-step="inputMessageSequenceDecodedExample">Готово</button>
                </div>
              </div>
            </div>
          </div>
          <div class="row" data-step="messageSequenceDecodedExampleHumanReadable">
            <div class="col-md-12">
              <div class="col-md-8 margin-vertical">
                Результат дешифровки:
              </div>
            </div>
          </div>
          <div class="row" data-step="messageSequenceDecodedExampleHumanReadable">
            <div class="col-md-12">
              <div class="col-md-8 input-group">
                <input type="text" class="form-control text-center" disabled id="message-decoded-example"/>
              </div>
            </div>
          </div>
          <div class="row" data-step="messageSequenceDecodedExampleHumanReadable">
            <div class="col-md-12">
              <div class="col-md-8 margin-vertical">
                Поздравляю! Можете переходить к тесту!
              </div>
            </div>
          </div>
          <div class="row" data-step="messageSequenceDecodedExampleHumanReadable">
            <div class="col-md-12">
              <div class="col-md-8 margin-vertical">
                <a class="btn btn-primary btn-lg" role="button" href="#test">Перейти к тесту</a>
              </div>
            </div>
          </div>
        </div>
      </div>
      <script src="assets/js/jquery.js"></script>
      <script src="assets/js/notify.js"></script>
      <script src="assets/js/sammy.js"></script>
      <script src="assets/js/big.js"></script>
      <script src="assets/js/main.js"></script>
  </body>
</html>
